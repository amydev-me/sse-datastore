(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{9:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n(4),r=n(5),u=n(1),o=n(7),i=n(6),c=n(2),d=n.n(c),l=n(8),h=n.n(l),p="https://counters-dot-sse-2021-jk.appspot.com/api/",j=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={name:e.name,isLoaded:!1,value:0,inputValue:""},a.inputValueChanged=a.inputValueChanged.bind(Object(u.a)(a)),a.updateValue=a.updateValue.bind(Object(u.a)(a)),a.addToCounter=a.addToCounter.bind(Object(u.a)(a)),a.setCounter=a.setCounter.bind(Object(u.a)(a)),a.refreshCounter=a.refreshCounter.bind(Object(u.a)(a)),a.deleteCounter=a.deleteCounter.bind(Object(u.a)(a)),a}return Object(r.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.updateValue(),this.timerID=setInterval((function(){return e.updateValue()}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"inputValueChanged",value:function(e){var t=e.target.value.replace(/\D/g,"");this.setState({inputValue:t})}},{key:"updateValue",value:function(){var e=this;fetch(p+this.state.name).then((function(e){return e.text()})).then((function(t){e.setState({isLoaded:!0,value:t})}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"addToCounter",value:function(e){var t=this,n={method:"POST",body:this.state.inputValue};fetch(p+this.state.name,n).then((function(e){return e.text()})).then((function(e){console.log(e),t.setState({isLoaded:!0,value:e})}),(function(e){t.setState({isLoaded:!0,error:e})}))}},{key:"setCounter",value:function(e){var t=this,n={method:"PUT",body:this.state.inputValue};fetch(p+this.state.name,n).then((function(e){return e.text()})).then((function(e){console.log(e),t.setState({isLoaded:!0,value:e})}),(function(e){t.setState({isLoaded:!0,error:e})}))}},{key:"refreshCounter",value:function(e){this.updateValue()}},{key:"deleteCounter",value:function(e){var t=this;fetch(p+this.state.name,{method:"DELETE"}).then((function(e){console.log(e),t.setState({isLoaded:!1}),t.props.deleteCounterHandler(t.props.name)}),(function(e){t.setState({isLoaded:!0,error:e})}))}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.isLoaded;return t?(console.log(t),Object(a.jsx)("div",{class:"counter",children:Object(a.jsxs)("p",{class:"name",children:[this.state.name," : ERROR"]})})):n?Object(a.jsxs)("div",{class:"counter",children:[Object(a.jsxs)("p",{class:"name",children:[this.state.name," : ",this.state.value]}),Object(a.jsx)("input",{type:"number",class:"counter_newval",value:this.state.inputValue,onChange:this.inputValueChanged}),Object(a.jsx)("button",{class:"add",onClick:this.addToCounter,children:"add"}),Object(a.jsx)("button",{class:"set",onClick:this.setCounter,children:"set"}),Object(a.jsx)("button",{class:"delete",onClick:this.deleteCounter,children:"delete"}),Object(a.jsx)("button",{class:"refresh",onClick:this.updateValue,children:"refresh"})]}):Object(a.jsx)("div",{class:"counter",children:Object(a.jsxs)("p",{class:"name",children:[this.state.name," : Loading..."]})})}}]),n}(d.a.Component),b=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={counters:[],counterNameInput:"",errorMessage:""},a.deleteCounterHandler=a.deleteCounterHandler.bind(Object(u.a)(a)),a.addCounter=a.addCounter.bind(Object(u.a)(a)),a.counterNameInputChanged=a.counterNameInputChanged.bind(Object(u.a)(a)),a.deleteCounterHandler=a.deleteCounterHandler.bind(Object(u.a)(a)),a}return Object(r.a)(n,[{key:"addCounter",value:function(e){if(""!=this.state.counterNameInput){var t=this.state.counters;t.push(this.state.counterNameInput),this.setState({counters:t})}}},{key:"counterNameInputChanged",value:function(e){var t=e.target.value.replace(/[^a-z0-9]/gi,"");this.setState({counterNameInput:t})}},{key:"deleteCounterHandler",value:function(e){var t=this.state.counters,n=t.indexOf(e);n>-1&&t.splice(n,1),this.setState({counters:t}),console.log(this.state.counters)}},{key:"render",value:function(){var e=[];for(var t in this.state.counters)e.push(Object(a.jsx)(j,{name:this.state.counters[t],deleteCounterHandler:this.deleteCounterHandler}));return Object(a.jsxs)("main",{children:[Object(a.jsx)("header",{children:Object(a.jsx)("h1",{children:"SSE : API with datastore"})}),Object(a.jsx)("section",{id:"add-counter",children:Object(a.jsxs)("p",{children:[Object(a.jsx)("input",{autoFocus:!0,id:"add-name",title:"only accepts digits and letters a-z",pattern:"[a-zA-Z0-9_]+",placeholder:"Enter name...",value:this.props.counterNameInput,onChange:this.counterNameInputChanged}),Object(a.jsx)("button",{id:"add-counter",onClick:this.addCounter,children:"Create"})]})}),Object(a.jsx)("section",{id:"counters",children:e}),Object(a.jsx)("footer",{children:Object(a.jsx)("p",{id:"error",children:this.props.errorMessage})})]})}}]),n}(d.a.Component);h.a.render(Object(a.jsx)(b,{}),document.getElementById("root"))}},[[9,1,2]]]);
//# sourceMappingURL=main.ebf37b59.chunk.js.map